# 🏯 Gateway of Regrets — 프로젝트 현황 문서

> **최종 업데이트**: 2026-02-18
> **기술 스택**: Flutter + Flame Engine (Dart)
> **핵심 문서**: `game_design_bible.md` (루트 디렉토리)

---

## 📂 프로젝트 구조

```
e:\01_defense\
├── lib/
│   ├── main.dart                 # 앱 진입점, 라우팅, 세이브/로드
│   ├── common/
│   │   ├── enums.dart            # TowerType, HeroId, EnemyId, Chapter 등
│   │   └── constants.dart        # DamageCalculator, 색상, 경로 설정
│   ├── data/
│   │   └── game_data_loader.dart # 영웅/적/타워/웨이브 정적 데이터
│   ├── game/
│   │   ├── td_world.dart         # 게임 월드 (맵, 웨이브 관리)
│   │   └── components/
│   │       ├── actors/
│   │       │   ├── base_enemy.dart    # 적 기본 클래스
│   │       │   └── base_hero.dart     # 영웅 기본 클래스 (5인)
│   │       ├── towers/
│   │       │   ├── base_tower.dart    # 타워 기본 클래스 (5종)
│   │       │   ├── barracks_soldier.dart # 병영 병사
│   │       │   └── rally_flag_component.dart # 랠리 포인트 깃발
│   │       ├── effects/
│   │       │   └── particle_effect.dart # 파티클 이펙트 시스템
│   │       └── ui/
│   │           ├── tower_build_menu.dart
│   │           ├── wave_banner.dart
│   │           └── hud_component.dart
│   └── ui/
│       ├── screens/
│       │   ├── hero_deploy_screen.dart # 영웅 선택 화면
│       │   └── map_screen.dart         # 챕터/스테이지 선택
│       └── dialogs/
│           └── hero_unlock_dialog.dart # 영웅 해금 축하 팝업
├── game_design_bible.md          # 게임 디자인 바이블 (GDD v4.0)
├── PROJECT_STATUS.md             # ← 이 문서
└── pubspec.yaml
```

---

## ✅ 구현 완료 항목

### 코어 시스템

- [x] 5종 타워 시스템 (궁수/병영/마법/화포/솟대) — enum + 데이터 + 기본 로직
- [x] 5종 영웅 시스템 (깨비/미호/강림/수아/바리) — 자동 전투 + 스킬
- [x] 18종 적 데이터 (챕터 1~3, 각 6종)
- [x] 챕터 1~3 웨이브 데이터 (총 12스테이지)
- [x] 상성 시스템 (물리/마법/정화 × 물리형/영혼형/요괴형)
- [x] 타워 건설/업그레이드/판매 UI
- [x] 랠리 포인트 드래그 이동 (병영 병사 위치 지정)

### 진행/보상 시스템

- [x] 별 판정 (게이트웨이 HP 잔량 기반 1~3성)
- [x] 스테이지 진행도 세이브/로드 (SharedPreferences)
- [x] 챕터 잠금 해제 조건 (이전 챕터 최종 스테이지 클리어)
- [x] 영웅 해금 시스템 (스테이지 기반 해금 + 축하 팝업)
- [x] 스테이지 잠금 표시 (별 아이콘 + 잠금 UI)

### 연출/UI

- [x] 웨이브 전환 배너 (웨이브 시작/보스 경고)
- [x] 승리/패배 화면 (별 획득 애니메이션)
- [x] 파티클 이펙트 시스템 (hit, death, explosion, heal, magic, heroSkill)
- [x] 영웅 스킬 이펙트 (5영웅 각 고유 색상/형태)
- [x] 영웅 해금 축하 다이얼로그 (탄성 애니메이션 + 영웅 정보)
- [x] 사운드 시스템 (BGM + SFX 기본 구조)

---

## 🔧 최근 밸런스 조정 (2026-02-18)

### 타워 밸런스

| 항목             | 변경 전 | 변경 후 |
| ---------------- | ------- | ------- |
| 화포 기본 사거리 | 180     | **220** |
| 화포 Lv2 사거리  | 200     | **250** |
| 화포 Lv3 사거리  | 220     | **280** |

### 병사 밸런스

| 항목         | 변경 전           | 변경 후              |
| ------------ | ----------------- | -------------------- |
| HP 공식      | 50 + (lv × 20)    | **25 + (lv × 10)**   |
| Lv1 HP       | 70                | **35**               |
| Lv2 HP       | 90                | **45**               |
| Lv3 HP       | 110               | **55**               |
| 이동 중 교전 | 랠리포인트 범위만 | **+ 병사 50px 근접** |
| 부활 대기    | 8초 (기존 유지)   | 8초                  |

### 스킨 경제 리밸런싱

- **광고 보상**: 50 → **30 신명석/회** (일 300, 월 ~9,000)
- **모든 스킨**: 신명석으로 구매 가능 (현금은 지름길)
- **시즌 패스 보상**: 500 → **1500~6000 신명석** (대폭 상향)
- **수집 페이싱**: F2P 전수집 ~2.5년, 시즌패스 ~1.5년

---

## ❌ 미구현 / 앞으로 할 작업

### 🔴 높은 우선순위 (Phase 1)

- [ ] 타워 Tier 4 분기 선택 시스템 (10개 분기 UI + 로직)
- [ ] 적 특수 능력 구현 (비행/은신/스폰/디버프)
- [ ] 원혼 정화 시스템 (솟대 연동, 원혼 드롭/흡수)
- [ ] 곡소리 게이지 (적 처치 → 게이지 상승 → 디버프)
- [ ] 낮/밤 전환 시스템 (시야/상성 변화)
- [ ] 배속 시스템 (1×/2×/3× 토글)

### 🟡 중간 우선순위 (Phase 2)

- [ ] 에피소드 1 풀 스테이지 (20스테이지 → 현재 4개)
- [ ] 에피소드 2~5 스테이지 확장
- [ ] 인터랙티브 맵 오브젝트 (성황당, 횃불, 우물 등)
- [ ] 유물/장비 시스템
- [ ] JSON 데이터 분리 (하드코딩 → 외부 파일)

### 🟢 낮은 우선순위 (Phase 3~4)

- [ ] 스프라이트 아트 + 애니메이션 (현재 도형 렌더링)
- [ ] 사운드/BGM 실제 에셋 적용
- [ ] 스킨 시스템 구현 (7등급 타워/영웅)
- [ ] 광고 시스템 (배너+보상형+부활)
- [ ] 시즌 패스 + VIP
- [ ] 소액 패키지 상점
- [ ] 무한의 탑 + 일일 도전
- [ ] 랭킹 + 업적 시스템

---

## 📋 알려진 이슈

1. **도형 렌더링**: 모든 유닛이 원/사각형으로 표시됨 (스프라이트 미적용)
2. **웨이브 4까지만**: 각 챕터 4개 스테이지만 구현
3. **병영 Tier 4 없음**: 분기 선택 UI/로직 미구현
4. **원혼 시스템 미구현**: 솟대 타워가 정화가 아닌 일반 버프만 제공

---

## 🔑 핵심 참조 파일

| 용도                | 파일 경로                                          |
| ------------------- | -------------------------------------------------- |
| 게임 디자인 바이블  | `game_design_bible.md`                             |
| 타워/영웅/적 데이터 | `lib/data/game_data_loader.dart`                   |
| enum 정의           | `lib/common/enums.dart`                            |
| 상성 계산           | `lib/common/constants.dart`                        |
| 메인 라우팅         | `lib/main.dart`                                    |
| 게임 월드           | `lib/game/td_world.dart`                           |
| 타워 기본 클래스    | `lib/game/components/towers/base_tower.dart`       |
| 병사 클래스         | `lib/game/components/towers/barracks_soldier.dart` |
| 영웅 기본 클래스    | `lib/game/components/actors/base_hero.dart`        |
| 적 기본 클래스      | `lib/game/components/actors/base_enemy.dart`       |
