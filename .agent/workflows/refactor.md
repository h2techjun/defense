---
description: Safe Refactoring Protocol (안전한 리팩토링)
---

# 안전한 리팩토링 프로토콜 (/refactor)

**Trigger:** `/refactor`
**Description:** 기존 코드를 기능 유지하면서 안전하게 구조 개선

---

## Step 1: 사전 검증 (Pre-Check)

```
1. 현재 빌드 상태 확인 (npm run build)
2. 기존 테스트 실행 (있으면)
3. 리팩토링 대상 파일 목록 확인
4. Git 상태 확인 (uncommitted 변경 없는지)
```

> ⚠️ 빌드 실패 상태에서는 리팩토링 금지 → 먼저 버그 수정

---

## Step 2: 리팩토링 계획

```
1. 변경 범위 정의 (어떤 파일, 어떤 함수)
2. 리팩토링 유형 선택:
   - 모듈 분리 (200줄 초과)
   - 중복 제거 (DRY)
   - 네이밍 개선
   - 타입 강화
   - 패턴 통일
3. 영향 받는 파일 목록
4. 리스크 평가
```

**사용자에게 계획 승인 요청**

---

## Step 3: 점진적 수정 (Incremental)

```
핵심 규칙:
  - 한 번에 최대 3개 파일만 수정
  - 수정 후 타입 체크
  - 통과 후 다음 배치

절대 금지:
  - 5개 이상 파일 동시 수정
  - 빌드 검증 없이 다음 단계
  - 기능 변경과 리팩토링 동시 진행
```

---

## Step 4: 사후 검증 (Post-Check)

```
1. 빌드 확인 (npm run build)
2. 기존 테스트 실행 (있으면)
3. 변경 전 동작과 동일한지 확인
4. 불필요한 import/변수 정리
```

---

## Step 5: 문서 업데이트

```
변경사항에 따라:
- CODEBASE_MAP.md 업데이트 (구조 변경 시)
- 주석 갱신 (함수명/파일명 변경 시)
```

---

**관리자**: @JARVIS
**마지막 업데이트**: 2026-02-13
